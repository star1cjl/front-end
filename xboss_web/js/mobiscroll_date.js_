(function(A){function M(au,at){var av,aB,ap,W,ax,U,aw,ab,af,am,ac,an=this,ae=A.mobiscroll,aA=au,az=A(aA),ar,Y,aq=l({},C),al={},ad=[],ak={},aa={},q=az.is("input"),aj=false;function ag(r){if(A.isArray(aq.readonly)){var aD=A(".dwwl",W).index(r);return aq.readonly[aD]}return aq.readonly}function ah(aF){var aD='<div class="dw-bf">',r=1,aE;for(aE in ad[aF]){if(r%20==0){aD+='</div><div class="dw-bf">'}aD+='<div class="dw-li dw-v" data-val="'+aE+'" style="height:'+aB+"px;line-height:"+aB+'px;"><div class="dw-i">'+ad[aF][aE]+"</div></div>";r++}aD+="</div>";return aD}function T(r){S=A(".dw-li",r).index(A(".dw-v",r).eq(0));t=A(".dw-li",r).index(A(".dw-v",r).eq(-1));z=A(".dw-ul",W).index(r);R=aB;B=an}function h(r){var aD=aq.headerText;return aD?(typeof aD==="function"?aD.call(aA,r):aD.replace(/\{value\}/i,r)):""}function ai(){an.temp=((q&&an.val!==null&&an.val!=az.val())||an.values===null)?aq.parseValue(az.val()||"",an):an.values.slice(0);an.setValue(true)}function ay(r,aG,aF,aE,aD){if(aC("validate",[W,aG,r])!==false){A(".dw-ul",W).each(function(aK){var aQ=A(this),aP=A('.dw-li[data-val="'+an.temp[aK]+'"]',aQ),aR=A(".dw-li",aQ),aO=aR.index(aP),aH=aR.length,aL=aK==aG||aG===undefined;if(!aP.hasClass("dw-v")){var aN=aP,aM=aP,aJ=0,aI=0;while(aO-aJ>=0&&!aN.hasClass("dw-v")){aJ++;aN=aR.eq(aO-aJ)}while(aO+aI<aH&&!aM.hasClass("dw-v")){aI++;aM=aR.eq(aO+aI)}if(((aI<aJ&&aI&&aE!==2)||!aJ||(aO-aJ<0)||aE==1)&&aM.hasClass("dw-v")){aP=aM;aO=aO+aI}else{aP=aN;aO=aO-aJ}}if(!(aP.hasClass("dw-sel"))||aL){an.temp[aK]=aP.attr("data-val");A(".dw-sel",aQ).removeClass("dw-sel");aP.addClass("dw-sel");an.scroll(aQ,aK,aO,aL?r:0.1,aL?aD:undefined)}});an.change(aF)}}function ao(aV){if(aq.display=="inline"||(ax===A(window).width()&&aw===A(window).height()&&aV)){return}var aJ,aP,aL,aK,aS,aN,aM,aQ,aD,aR,r,aE,aU=0,aG=0,aO=A(window).scrollTop(),aF=A(".dwwr",W),aT=A(".dw",W),aI={},aH=aq.anchor===undefined?az:aq.anchor;ax=A(window).width();aw=A(window).height();U=window.innerHeight;U=U||aw;if(/modal|bubble/.test(aq.display)){A(".dwc",W).each(function(){aJ=A(this).outerWidth(true);aU+=aJ;aG=(aJ>aG)?aJ:aG});aJ=aU>ax?aG:aU;aF.width(aJ)}ab=aT.outerWidth();af=aT.outerHeight(true);if(aq.display=="modal"){aP=(ax-ab)/2;aL=aO+(U-af)/2}else{if(aq.display=="bubble"){aE=true;aD=A(".dw-arrw-i",W);aN=aH.offset();aM=aN.top;aQ=aN.left;aK=aH.outerWidth();aS=aH.outerHeight();aP=aQ-(aT.outerWidth(true)-aK)/2;aP=aP>(ax-ab)?(ax-(ab+20)):aP;aP=aP>=0?aP:20;aL=aM-af;if((aL<aO)||(aM>aO+U)){aT.removeClass("dw-bubble-top").addClass("dw-bubble-bottom");aL=aM+aS}else{aT.removeClass("dw-bubble-bottom").addClass("dw-bubble-top")}aR=aD.outerWidth();r=aQ+aK/2-(aP+(ab-aR)/2);A(".dw-arr",W).css({left:r>aR?aR:r})}else{aI.width="100%";if(aq.display=="top"){aL=aO}else{if(aq.display=="bottom"){aL=aO+U-af}}}}aI.top=aL<0?0:aL;aI.left=aP;aT.css(aI);A(".dw-persp",W).height(0).height(aL+af>A(document).height()?aL+af:A(document).height());if(aE&&((aL+af>aO+U)||(aM>aO+U))){A(window).scrollTop(aL+af-U)}}function X(r){if(r.type==="touchstart"){N=true;setTimeout(function(){N=false},500)}else{if(N){N=false;return false}}return true}function aC(aD,r){var aE;r.push(an);A.each([ar.defaults,al,at],function(aG,aF){if(aF[aD]){aE=aF[aD].apply(aA,r)}});return aE}function V(r){var aD=+r.data("pos"),aE=aD+1;j(r,aE>t?S:aE,1,true)}function Z(r){var aD=+r.data("pos"),aE=aD-1;j(r,aE<S?t:aE,2,true)}an.enable=function(){aq.disabled=false;if(q){az.prop("disabled",false)}};an.disable=function(){aq.disabled=true;if(q){az.prop("disabled",true)}};an.scroll=function(aK,aI,aG,aF,aE){function aJ(aM,aL,aO,aN){return aO*Math.sin(aM/aN*(Math.PI/2))+aL}function aH(){clearInterval(ak[aI]);delete ak[aI];aK.data("pos",aG).closest(".dwwl").removeClass("dwa")}var aD=(av-aG)*aB,r;if(aD==aa[aI]&&ak[aI]){return}if(aF&&aD!=aa[aI]){aC("onAnimStart",[W,aI,aF])}aa[aI]=aD;aK.attr("style",(G+"-transition:all "+(aF?aF.toFixed(3):0)+"s ease-out;")+(o?(G+"-transform:translate3d(0,"+aD+"px,0);"):("top:"+aD+"px;")));if(ak[aI]){aH()}if(aF&&aE!==undefined){r=0;aK.closest(".dwwl").addClass("dwa");ak[aI]=setInterval(function(){r+=0.1;aK.data("pos",Math.round(aJ(r,aE,aG-aE,aF)));if(r>=aF){aH()}},100)}else{aK.data("pos",aG)}};an.setValue=function(aD,r,aF,aE){if(!A.isArray(an.temp)){an.temp=aq.parseValue(an.temp+"",an)}if(aj&&aD){ay(aF)}ap=aq.formatResult(an.temp);if(!aE){an.values=an.temp.slice(0);an.val=ap}if(r){if(q){az.val(ap).trigger("change")}}};an.getValues=function(){var r=[],aD;for(aD in an._selectedValues){r.push(an._selectedValues[aD])}return r};an.validate=function(aE,aD,r,aF){ay(r,aE,true,aD,aF)};an.change=function(r){ap=aq.formatResult(an.temp);if(aq.display=="inline"){an.setValue(false,r)}else{A(".dwv",W).html(h(ap))}if(r){aC("onChange",[ap])}};an.changeWheel=function(aD,r){if(W){var aG=0,aF,aE,aH=aD.length;for(aF in aq.wheels){for(aE in aq.wheels[aF]){if(A.inArray(aG,aD)>-1){ad[aG]=aq.wheels[aF][aE];A(".dw-ul",W).eq(aG).html(ah(aG));aH--;if(!aH){ao();ay(r,undefined,true);return}}aG++}}}};an.isVisible=function(){return aj};an.tap=function(aE,aD){var aF,r;if(aq.tap){aE.bind("touchstart",function(aG){aG.preventDefault();aF=m(aG,"X");r=m(aG,"Y")}).bind("touchend",function(aG){if(Math.abs(m(aG,"X")-aF)<20&&Math.abs(m(aG,"Y")-r)<20){aD.call(this,aG)}H=true;setTimeout(function(){H=false},300)})}aE.bind("click",function(aG){if(!H){aD.call(this,aG)}})};an.show=function(r){if(aq.disabled||aj){return false}if(aq.display=="top"){am="slidedown"}if(aq.display=="bottom"){am="slideup"}ai();aC("onBeforeShow",[W]);var aD=0,aF,aE,aG="";if(am&&!r){aG="dw-"+am+" dw-in"}var aH='<div class="dw-trans '+aq.theme+" dw-"+aq.display+'">'+(aq.display=="inline"?'<div class="dw dwbg dwi"><div class="dwwr">':'<div class="dw-persp"><div class="dwo"></div><div class="dw dwbg '+aG+'"><div class="dw-arrw"><div class="dw-arrw-i"><div class="dw-arr"></div></div></div><div class="dwwr">'+(aq.headerText?'<div class="dwv"></div>':""));for(aF=0;aF<aq.wheels.length;aF++){aH+='<div class="dwc'+(aq.mode!="scroller"?" dwpm":" dwsc")+(aq.showLabel?"":" dwhl")+'"><div class="dwwc dwrc"><table cellpadding="0" cellspacing="0"><tr>';for(aE in aq.wheels[aF]){ad[aD]=aq.wheels[aF][aE];aH+='<td><div class="dwwl dwrc dwwl'+aD+'">'+(aq.mode!="scroller"?'<div class="dwwb dwwbp" style="height:'+aB+"px;line-height:"+aB+'px;"><span>+</span></div><div class="dwwb dwwbm" style="height:'+aB+"px;line-height:"+aB+'px;"><span>&ndash;</span></div>':"")+'<div class="dwl">'+aE+'</div><div class="dww" style="height:'+(aq.rows*aB)+"px;min-width:"+aq.width+'px;"><div class="dw-ul">';aH+=ah(aD);aH+='</div><div class="dwwo"></div></div><div class="dwwol"></div></div></td>';aD++}aH+="</tr></table></div></div>"}aH+=(aq.display!="inline"?'<div class="dwbc'+(aq.button3?" dwbc-p":"")+'"><span class="dwbw dwb-s"><span class="dwb">'+aq.setText+"</span></span>"+(aq.button3?'<span class="dwbw dwb-n"><span class="dwb">'+aq.button3Text+"</span></span>":"")+'<span class="dwbw dwb-c"><span class="dwb">'+aq.cancelText+"</span></span></div></div>":'<div class="dwcc"></div>')+"</div></div></div>";W=A(aH);ay();aC("onMarkupReady",[W]);if(aq.display!="inline"){W.appendTo("body");setTimeout(function(){W.removeClass("dw-trans").find(".dw").removeClass(aG)},350)}else{if(az.is("div")){az.html(W)}else{W.insertAfter(az)}}aC("onMarkupInserted",[W]);aj=true;ar.init(W,an);if(aq.display!="inline"){an.tap(A(".dwb-s span",W),function(){if(an.hide(false,"set")!==false){an.setValue(false,true);aC("onSelect",[an.val])}});an.tap(A(".dwb-c span",W),function(){an.cancel()});if(aq.button3){an.tap(A(".dwb-n span",W),aq.button3)}if(aq.scrollLock){W.bind("touchmove",function(aI){if(af<=U&&ab<=ax){aI.preventDefault()}})}A("input,select,button").each(function(){if(!A(this).prop("disabled")){A(this).addClass("dwtd").prop("disabled",true)}});ao();A(window).bind("resize.dw",function(){clearTimeout(ac);ac=setTimeout(function(){ao(true)},100)})}W.delegate(".dwwl","DOMMouseScroll mousewheel",function(aL){if(!ag(this)){aL.preventDefault();aL=aL.originalEvent;var aI=aL.wheelDelta?(aL.wheelDelta/120):(aL.detail?(-aL.detail/3):0),aJ=A(".dw-ul",this),aK=+aJ.data("pos"),aM=Math.round(aK-aI);T(aJ);j(aJ,aM,aI<0?1:2)}}).delegate(".dwb, .dwwb",i,function(aI){A(this).addClass("dwb-a")}).delegate(".dwwb",i,function(aL){aL.stopPropagation();aL.preventDefault();var aI=A(this).closest(".dwwl");if(X(aL)&&!ag(aI)&&!aI.hasClass("dwa")){E=true;var aJ=aI.find(".dw-ul"),aK=A(this).hasClass("dwwbp")?V:Z;T(aJ);clearInterval(v);v=setInterval(function(){aK(aJ)},aq.delay);aK(aJ)}}).delegate(".dwwl",i,function(aI){aI.preventDefault();if(X(aI)&&!n&&!ag(this)&&!E){n=true;A(document).bind(F,p);a=A(".dw-ul",this);y=aq.mode!="clickpick";w=+a.data("pos");T(a);d=ak[z]!==undefined;u=m(aI,"Y");g=new Date();s=u;an.scroll(a,z,w,0.001);if(y){a.closest(".dwwl").addClass("dwa")}}});aC("onShow",[W,ap])};an.hide=function(aD,r){if(!aj||aC("onClose",[ap,r])===false){return false}A(".dwtd").prop("disabled",false).removeClass("dwtd");az.blur();if(W){if(aq.display!="inline"&&am&&!aD){W.addClass("dw-trans").find(".dw").addClass("dw-"+am+" dw-out");setTimeout(function(){W.remove();W=null},350)}else{W.remove();W=null}aj=false;aa={};A(window).unbind(".dw")}};an.cancel=function(){if(an.hide(false,"cancel")!==false){aC("onCancel",[an.val])}};an.init=function(aD){ar=l({defaults:{},init:b},ae.themes[aD.theme||aq.theme]);Y=ae.i18n[aD.lang||aq.lang];l(at,aD);l(aq,ar.defaults,Y,at);an.settings=aq;az.unbind(".dw");var r=ae.presets[aq.preset];if(r){al=r.call(aA,an);l(aq,al,at);l(D,al.methods)}av=Math.floor(aq.rows/2);aB=aq.height;am=aq.animate;if(az.data("dwro")!==undefined){aA.readOnly=c(az.data("dwro"))}if(aj){an.hide()}if(aq.display=="inline"){an.show()}else{ai();if(q&&aq.showOnFocus){az.data("dwro",aA.readOnly);aA.readOnly=true;az.bind("focus.dw",function(){an.show()})}}};an.trigger=function(aD,r){return aC(aD,r)};an.values=null;an.val=null;an.temp=null;an._selectedValues={};an.init(at)}function I(h){var q;for(q in h){if(e[h[q]]!==undefined){return true}}return false}function x(){var h=["Webkit","Moz","O","ms"],q;for(q in h){if(I([h[q]+"Transform"])){return"-"+h[q].toLowerCase()}}return""}function f(h){return L[h.id]}function m(r,T){var h=r.originalEvent,q=r.changedTouches;return q||(h&&h.changedTouches)?(h?h.changedTouches[0]["page"+T]:q[0]["page"+T]):r["page"+T]}function c(h){return(h===true||h=="true")}function P(q,h,r){q=q>r?r:q;q=q<h?h:q;return q}function j(Y,W,V,U,T){W=P(W,S,t);var r=A(".dw-li",Y).eq(W),h=T===undefined?W:T,X=z,q=U?(W==h?0.1:Math.abs((W-h)*0.1)):0;B.temp[X]=r.attr("data-val");B.scroll(Y,X,W,q,T);setTimeout(function(){B.validate(X,V,q,T)},10)}function O(q,h,r){if(D[h]){return D[h].apply(q,Array.prototype.slice.call(r,1))}if(typeof h==="object"){return D.init.call(q,h)}return q}var L={},v,b=function(){},R,S,t,B,Q=new Date(),k=Q.getTime(),n,E,a,z,u,s,g,w,d,y,e=document.createElement("modernizr").style,o=I(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]),G=x(),l=A.extend,H,N,i="touchstart mousedown",F="touchmove mousemove",J="touchend mouseup",p=function(h){if(y){h.preventDefault();s=m(h,"Y");B.scroll(a,z,P(w+(u-s)/R,S-1,t+1))}d=true},C={width:70,height:40,rows:3,delay:300,disabled:false,readonly:false,showOnFocus:true,showLabel:true,wheels:[],theme:"",headerText:"{value}",display:"modal",mode:"scroller",preset:"",lang:"en-US",setText:"Set",cancelText:"Cancel",scrollLock:true,tap:true,formatResult:function(h){return h.join(" ")},parseValue:function(W,V){var X=V.settings.wheels,h=W.split(" "),U=[],r=0,T,q,Y;for(T=0;T<X.length;T++){for(q in X[T]){if(X[T][q][h[r]]!==undefined){U.push(h[r])}else{for(Y in X[T][q]){U.push(Y);break}}r++}}return U}},D={init:function(h){if(h===undefined){h={}}return this.each(function(){if(!this.id){k+=1;this.id="scoller"+k}L[this.id]=new M(this,h)})},enable:function(){return this.each(function(){var h=f(this);if(h){h.enable()}})},disable:function(){return this.each(function(){var h=f(this);if(h){h.disable()}})},isDisabled:function(){var h=f(this[0]);if(h){return h.settings.disabled}},isVisible:function(){var h=f(this[0]);if(h){return h.isVisible()}},option:function(q,h){return this.each(function(){var T=f(this);if(T){var r={};if(typeof q==="object"){r=q}else{r[q]=h}T.init(r)}})},setValue:function(r,h,T,q){return this.each(function(){var U=f(this);if(U){U.temp=r;U.setValue(true,h,T,q)}})},getInst:function(){return f(this[0])},getValue:function(){var h=f(this[0]);if(h){return h.values}},getValues:function(){var h=f(this[0]);if(h){return h.getValues()}},show:function(){var h=f(this[0]);if(h){return h.show()}},hide:function(){return this.each(function(){var h=f(this);if(h){h.hide()}})},destroy:function(){return this.each(function(){var h=f(this);if(h){h.hide();A(this).unbind(".dw");delete L[this.id];if(A(this).is("input")){this.readOnly=c(A(this).data("dwro"))}}})}};A(document).bind(J,function(V){if(n){var Y=new Date()-g,r=P(w+(u-s)/R,S-1,t+1),T,W,q,U=a.offset().top;if(Y<300){T=(s-u)/Y;W=(T*T)/(2*0.0006);if(s-u<0){W=-W}}else{W=s-u}q=Math.round(w-W/R);if(!W&&!d){var X=Math.floor((s-U)/R),Z=A(".dw-li",a).eq(X),h=y;if(B.trigger("onValueTap",[Z])!==false){q=X}else{h=true}if(h){Z.addClass("dw-hl");setTimeout(function(){Z.removeClass("dw-hl")},200)}}if(y){j(a,q,0,true,Math.round(r))}n=false;a=null;A(document).unbind(F,p)}if(E){clearInterval(v);E=false}A(".dwb-a").removeClass("dwb-a")}).bind("mouseover mouseup mousedown click",function(h){if(H){h.stopPropagation();h.preventDefault();return false}});A.fn.mobiscroll=function(h){l(this,A.mobiscroll.shorts);return O(this,h,arguments)};A.mobiscroll=A.mobiscroll||{setDefaults:function(h){l(C,h)},presetShort:function(h){this.shorts[h]=function(q){return O(this,l(q,{preset:h}),arguments)}},shorts:{},presets:{},themes:{},i18n:{}};A.scroller=A.scroller||A.mobiscroll;A.fn.scroller=A.fn.scroller||A.fn.mobiscroll;A.mobiscroll.i18n.zh=A.extend(A.mobiscroll.i18n.zh,{dateFormat:"yyyy-mm-dd",dateOrder:"yymmdd",dayNames:["周日","周一;","周二;","周三","周四","周五","周六"],dayNamesShort:["日","一","二","三","四","五","六"],dayText:"日",hourText:"时",minuteText:"分",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthText:"月",secText:"秒",timeFormat:"HH:ii",timeWheels:"HHii",yearText:"年"});A.mobiscroll.i18n.zh=A.extend(A.mobiscroll.i18n.zh,{setText:"确定",cancelText:"取消"});var K={defaults:{dateOrder:"Mddyy",mode:"mixed",rows:5,width:70,height:36,showLabel:true,useShortLabels:true}};A.mobiscroll.themes["android-ics"]=K;A.mobiscroll.themes["android-ics light"]=K})(jQuery);